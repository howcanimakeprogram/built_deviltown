<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DEVILTOWN</title>
  <link rel="stylesheet" href="css/style.css?v=2.5">
</head>

<body>

  <canvas id="noise"></canvas>

  <!-- Entrance Gate (Devil 666 - User's Original Design) -->
  <div id="gateOverlay" style="
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 9999;
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f6f7f9;
    color: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
  ">
    <div style="width: 90%; max-width: 900px;">
      <h1 style="font-size: 48px; font-weight: 500; margin-bottom: 10px;">
        Bad gateway
        <span
          style="display: inline-block; background: #eee; padding: 6px 12px; border-radius: 20px; font-size: 14px; margin-left: 10px; vertical-align: middle;">Error
          code 666</span>
      </h1>

      <div style="display: flex; justify-content: space-between; margin: 40px 0; gap: 20px; flex-wrap: wrap;">
        <div
          style="flex: 1; min-width: 200px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
          <div style="font-size: 30px; margin-bottom: 10px;">ğŸ–¥ï¸</div>
          <div>Browser</div>
          <div style="color: #2ecc71; font-weight: 600;">Working</div>
        </div>

        <div
          style="flex: 1; min-width: 200px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
          <div style="font-size: 30px; margin-bottom: 10px;">â˜ï¸</div>
          <div>Hellfire Gateway</div>
          <div style="color: #2ecc71; font-weight: 600;">Working</div>
        </div>

        <div
          style="flex: 1; min-width: 200px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
          <div style="font-size: 30px; margin-bottom: 10px;">ğŸ–¥ï¸</div>
          <div>Host</div>
          <div style="color: #e74c3c; font-weight: 600;">Summoning...</div>
        </div>
      </div>

      <div style="margin-top: 30px;">
        <h2>What happened?</h2>
        <p>The underworld server is testing your identity.</p>
      </div>

      <div style="margin-top: 30px;">
        <h2>What can I do?</h2>
        <p>If you are a devil, confirm below.</p>
      </div>

      <div
        style="margin-top: 30px; padding: 20px; border: 3px solid black; border-radius: 50px; display: inline-block;">
        <label>
          <input type="checkbox" id="devilCheck">
          If you are a devil, check this box and press Enter.
        </label>
        <br>
        <button id="enterBtn"
          style="margin-top: 20px; padding: 10px 25px; font-size: 16px; border: none; background: black; color: white; border-radius: 6px; cursor: pointer;">Enter</button>
      </div>

      <div style="margin-top: 40px; font-size: 12px; color: #888;">
        Hellfire Ray ID: <span id="rayId">666-DEVIL-001</span><br>
        Your Soul ID: ********
      </div>
    </div>
  </div>

  <!-- Intro stage -->
  <div class="stage">
    <div id="art">
      <pre id="ascii"><span id="skullSpan"></span><span id="logoSpan"></span></pre>
    </div>
  </div>

  <!-- Game Result Area (Moved out to be on top) -->
  <div id="gameResult" style="
    position: fixed; 
    top: 50px; 
    left: 50%; 
    transform: translateX(-50%); 
    text-align: center; 
    pointer-events: none; 
    display: none; 
    z-index: 1000;
    font-family: inherit;
    width: 90%;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(5px);
    padding: 20px;
    border-radius: 20px;
    border: 1px solid rgba(255,0,0,0.2);
  "></div>

  <!-- Top-right menu -->
  <button id="menuBtn" class="menu-btn" aria-label="Open menu" aria-expanded="false">MENU</button>
  <div id="menuOverlay" class="menu-overlay" hidden></div>

  <aside id="menuPanel" class="menu-panel" aria-hidden="true">
    <div class="menu-header">
      <div class="menu-title">DEVILTOWN</div>
      <button id="menuClose" class="menu-close" aria-label="Close menu">âœ•</button>
    </div>

    <nav class="menu-items">
      <button class="menu-item" data-key="wtfis">whatthefuckisdeviltown</button>
      <button class="menu-item" data-key="schedule">Schedule</button>
      <button class="menu-item" data-key="archive">Archive (Photo/Video)</button>
      <button class="menu-item" data-key="mixes">Mixes</button>
      <button class="menu-item" data-key="marathoner">Marathoner</button>
      <button class="menu-item" data-key="skullgame">ğŸ² SKULL Dice</button>
      <button class="menu-item" data-key="devilcoach">Devil Coach (AI)</button>
    </nav>

    <div class="menu-help">
      click item â†’ open page<br />
      ESC â†’ close<br />
      SPACE / tap â†’ replay intro
    </div>
  </aside>

  <!-- Page overlay -->
  <div id="pageOverlay" hidden></div>

  <!-- Video modal -->
  <div id="videoModal" aria-hidden="true">
    <div id="videoModalBg" class="video-modal-bg"></div>
    <div class="video-modal-panel" role="dialog" aria-modal="true" aria-label="Video player">
      <div class="video-modal-head">
        <div id="videoModalTitle" class="video-modal-title">Playlist</div>
        <button id="videoModalClose" class="video-modal-close" aria-label="Close video">âœ•</button>
      </div>
      <div class="video-modal-body" style="position:relative;">
        <!-- Navigation Buttons -->
        <button id="btnPrevVideo" class="nav-btn prev" aria-label="Previous video">â®</button>
        <button id="btnNextVideo" class="nav-btn next" aria-label="Next video">â¯</button>

        <iframe id="videoModalFrame" class="video-frame" src="" title="YouTube video" frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen>
        </iframe>
        <div id="videoCounter"
          style="text-align:center; margin-top:10px; font-size:12px; opacity:0.7; font-weight:bold;"></div>

        <!-- Playlist (TOC) -->
        <div id="videoPlaylist" class="video-playlist"></div>
      </div>
    </div>
  </div>

  <!-- Page container (overlay panel) -->
  <section id="content" aria-hidden="true">
    <div class="content-header">
      <div id="contentTitle" class="content-title">DEVILTOWN</div>
      <button id="pageClose" class="content-close" aria-label="Close page">âœ•</button>
    </div>

    <div class="content-body">
      <div id="sec-wtfis" class="section">
        <p style="text-align:center; opacity:0.7; font-size:14px; margin-bottom:20px;">ë¡œê³  / ë””ìì¸ íŒŒì¼ / ë„ì•ˆ / ê·¸ë˜í”½ ì‹¤í—˜ / ë¹„ì£¼ì–¼
          ì‘ì—… ì•„ì¹´ì´ë¸Œ.</p>
        <div class="grid" style="margin-top:12px;">
          <div class="card">
            <div class="thumb">LOGO</div>
            <div class="small" style="margin-top:10px;">DEVILTOWN logo set</div>
          </div>
          <div class="card">
            <div class="thumb">TEES</div>
            <div class="small" style="margin-top:10px;">T-shirt graphics</div>
          </div>
          <div class="card">
            <div class="thumb">POSTER</div>
            <div class="small" style="margin-top:10px;">Posters / Flyers</div>
          </div>
        </div>
      </div>

      <!-- SKULL Dice Section -->
      <div id="sec-skullgame" class="section">
        <div class="game-box" style="
          margin: 10px 0; 
          padding: 60px 20px; 
          border: 1px dashed rgba(255,100,100,0.3); 
          background: rgba(20,0,0,0.3); 
          text-align: center;
          position: relative;
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: center;
          gap: 40px;
        ">
          <!-- Button is now the main focus; results pop up at the very top of the screen -->
          <button id="skullGameBtn" class="btn" style="
            background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%); 
            border: none; 
            font-size: 20px; 
            padding: 20px 45px;
            border-radius: 50px;
            font-weight: 900;
            cursor: pointer;
            box-shadow: 0 10px 25px rgba(255,0,0,0.4);
            z-index: 101;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
          ">
            ROLL THE SKULL DICE ğŸ²
          </button>

          <!-- Result appears here below the button -->
          <div id="miniGameResult" style="
            width: 100%;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 10px;
            z-index: 100;
          "></div>

          <div style="font-size: 13px; color: #888; font-family: monospace; letter-spacing: 1px; opacity:0.8;">
            (CHANCE: 0km : 1% | 30km : 5% | Full : 1%)
          </div>
        </div>
      </div>

      <!-- Devil Coach Section -->
      <div id="sec-devilcoach" class="section">
        <p style="text-align:center; opacity:0.7; font-size:13px; margin-bottom:20px;">ìš•ìŸì´ AI ì½”ì¹˜ì™€ ëŒ€í™”í•˜ì„¸ìš”. ì°°ì§„ íŒ©íŠ¸ í­ê²©ìœ¼ë¡œ ì •ì‹ 
          ì°¨ë¦¬ê²Œ í•´ë“œë¦½ë‹ˆë‹¤.</p>

        <!-- Chat Interface -->
        <div class="coach-chat-container" style="
          margin-top: 20px;
          background: rgba(0,0,0,0.5);
          border: 1px solid rgba(255,0,0,0.3);
          border-radius: 10px;
          overflow: hidden;
        ">
          <div id="coachChatMessages" style="
            height: 400px;
            overflow-y: auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            gap: 10px;
          ">
            <div class="coach-message" style="
              background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
              padding: 12px 15px;
              border-radius: 10px;
              max-width: 80%;
              align-self: flex-start;
              color: #fff;
              line-height: 1.5;
              font-size: 14px;
            ">
              ì•¼ ìƒˆë¼ì•¼, ë­ ë¬¼ì–´ë³¼ ê±° ìˆëƒ? ë›°ê¸° ì‹«ë‹¤ê³  ì§•ì§•ëŒ€ì§€ ë§ê³  ì§ˆë¬¸ì´ë‚˜ í•´ë¼ ã…‹ã…‹
            </div>
          </div>

          <div style="
            padding: 15px;
            background: rgba(30,30,30,0.8);
            border-top: 1px solid rgba(255,0,0,0.3);
            display: flex;
            gap: 10px;
          ">
            <input type="text" id="coachInput" placeholder="ì—¬ê¸°ë‹¤ ì³ë´... (ì˜ˆ: ì˜¤ëŠ˜ 10km ë›°ë ¤ëŠ”ë° ì¤€ë¹„ìš´ë™ ë­í•´?)" style="
                flex: 1;
                padding: 12px 15px;
                background: rgba(20,20,20,0.9);
                border: 1px solid rgba(255,0,0,0.3);
                border-radius: 20px;
                color: #fff;
                font-size: 14px;
                outline: none;
              " />
            <button id="coachSendBtn" class="btn" style="
              padding: 12px 25px;
              background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
              border: none;
              border-radius: 20px;
              font-weight: bold;
              cursor: pointer;
            ">
              ë³´ë‚´ê¸°
            </button>
          </div>
        </div>

        <div id="coachLoading" style="
          display: none;
          text-align: center;
          margin-top: 10px;
          font-size: 12px;
          opacity: 0.7;
        ">
          <span>ì½”ì¹˜ê°€ ë‹µë³€ ì¤€ë¹„ ì¤‘...</span>
        </div>
      </div>

      <div id="sec-schedule" class="section">
        <p style="text-align:center; opacity:0.7; font-size:14px; margin-bottom:20px;">ë ˆì´ìŠ¤ / íŠ¸ë˜ë¸” / ì´ë²¤íŠ¸ ê³µìœ  ìº˜ë¦°ë”</p>

        <div class="card" style="margin-top:20px; text-align:center; padding: 20px;">
          <div style="font-size:14px; margin-bottom:15px; opacity:0.8;">
            <p>ëª¨ë“  ì¼ì •ì€ iCloud ìº˜ë¦°ë”ë¡œ ê´€ë¦¬ë©ë‹ˆë‹¤.</p>
            <p>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ êµ¬ë…í•˜ì„¸ìš”.</p>
          </div>
          <a class="btn" target="_blank"
            href="webcal://p44-caldav.icloud.com/published/2/NDE4ODE1NjY2NDE4ODE1NqDjLwq8GMN_zupBHSe0DAmmz8VvM5LEnkcLBL298CvgpMqp9UnWVYdyl0KkEr3T51GFC-uIzKH_pnozZxt_HFc"
            style="display:inline-block; margin:0 auto;">
            ğŸ“… iCloud Calendar êµ¬ë…
          </a>
        </div>
      </div>

      <div id="sec-archive" class="section">
        <p style="text-align:center; opacity:0.7; font-size:14px; margin-bottom:20px;">í¬í†  / ë¹„ë””ì˜¤ ì•„ì¹´ì´ë¸Œ (ë¹„ë””ì˜¤ëŠ” ìœ íŠœë¸Œ ì—…ë¡œë“œ ì˜ˆì •)
        </p>

        <div class="grid" style="margin-top:12px;">
          <div class="card">
            <div class="thumb">PHOTO</div>
            <div class="small" style="margin-top:10px;">2nd anniversary</div>
          </div>

          <div class="card">
            <button class="playlist-open" data-title="ÄÉ†VÅ‚â± â‚®Ã˜â‚©â‚¦ â±¤É†â‚³ÄÉ 2 Äâ±¤Å‚â‚¦â‚­"
              data-videos="o2_g_GyF1iE,TzyiGAERKVw,vbeBVo2jiRY,_7P7_9RgDQM,vbeBVo2jiRY,w35YjgOUaZk"
              data-titles="CHBS,tejava_assassins,VIC_CATLE,FAACIA,TENJU,mhmd"
              data-instagrams="https://www.instagram.com/givemeazerocoke/,https://www.instagram.com/tejava_assassins/,https://www.instagram.com/vic_catle/,https://www.instagram.com/faacia.or0/,https://www.instagram.com/tenjumakes/,https://www.instagram.com/mhmd_muhammmmmad/">
              <div class="thumb">VIDEO</div>
              <div class="small" style="margin-top:10px;">
                ÄÉ†VÅ‚â± â‚®Ã˜â‚©â‚¦ â±¤É†â‚³ÄÉ† 2 Äâ±¤Å‚â‚¦â‚­ â–¶
              </div>
            </button>
          </div>

          <div class="card">
            <div class="thumb">DESIGN</div>
            <div class="small" style="margin-top:10px;">Artwork archive</div>
          </div>

          <div class="card">
            <div class="thumb">PHOTO</div>
            <div class="small" style="margin-top:10px;">Album placeholder</div>
          </div>

          <div class="card">
            <div class="thumb">VIDEO</div>
            <div class="small" style="margin-top:10px;">Playlist placeholder</div>
          </div>

          <div class="card">
            <div class="thumb">DESIGN</div>
            <div class="small" style="margin-top:10px;">Archive placeholder</div>
          </div>
        </div>
      </div>

      <div id="sec-mixes" class="section">
        <p style="text-align:center; opacity:0.7; font-size:14px; margin-bottom:20px;">ë¯¹ìŠ¤ì…‹ ì—…ë¡œë“œ ë°©ì‹ í™•ì •ë˜ë©´ ì—¬ê¸°ì— ì—°ê²°.</p>
        <div class="grid" style="margin-top:12px;">
          <div class="card">
            <div class="thumb">MIX #1</div>
            <div class="small" style="margin-top:10px;">placeholder</div>
          </div>
          <div class="card">
            <div class="thumb">MIX #2</div>
            <div class="small" style="margin-top:10px;">placeholder</div>
          </div>
          <div class="card">
            <div class="thumb">MIX #3</div>
            <div class="small" style="margin-top:10px;">placeholder</div>
          </div>
        </div>
      </div>

      <div id="sec-marathoner" class="section">
        <p style="text-align:center; opacity:0.7; font-size:14px; margin-bottom:20px;">ëŸ¬ë‹ ê¸°ë¡ + ì‚¬ì§„ + ì´ë ¥ (ì¼ë‹¨ ì‚¬ì§„ì€ ì•„ìŠ¤í‚¤ í•´ê³¨ë¡œ
          ëŒ€ì²´)</p>

        <div class="run-grid" style="margin-top:12px;">
          <div class="card">
            <div><b>Race #1</b> Â· 42.195K Â· 00:00:00</div>
            <div class="small">YYYY-MM-DD Â· Location</div>
            <div class="run-photo">
              <pre class="runSkull"></pre>
            </div>
          </div>
          <div class="card">
            <div><b>Race #2</b> Â· 21.1K Â· 00:00:00</div>
            <div class="small">YYYY-MM-DD Â· Location</div>
            <div class="run-photo">
              <pre class="runSkull"></pre>
            </div>
          </div>
          <div class="card">

            <div><b>Race #3</b> Â· 10K Â· 00:00:00</div>
            <div class="small">YYYY-MM-DD Â· Location</div>
            <div class="run-photo">
              <pre class="runSkull"></pre>
            </div>
          </div>
          <div class="card">
            <div><b>Race #4</b> Â· Trail Â· 00:00:00</div>
            <div class="small">YYYY-MM-DD Â· Location</div>
            <div class="run-photo">
              <pre class="runSkull"></pre>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- Imports -->
  <!-- Main Scripts -->
  <script src="js/script.js?v=2.0"></script>
  <script src="js/devil_coach_chat.js?v=2.0"></script>
</body>

</html>